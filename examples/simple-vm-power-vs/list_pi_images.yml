---
- name: List Power Virtual Server Cloud Images
  hosts: all
  collections:
   - ibm.cloudcollection
  vars:
    pi_cloud_instance_id: "1370c926-55ef-42ab-b5d7-5f6307595b37"

  tasks:        
    - ibm_pi_images_info:
        pi_cloud_instance_id: "{{ pi_cloud_instance_id }}"
        region: "osa"
        zone: "osa21"
        ibmcloud_api_key: "7-uVQ3adjDsANxOQ7TC0h3r6Yt3CdJW2OubNVek1e11m"
      register: images_list

    - debug:
        var: images_list.resource.image_info |
             items2dict(key_name='name', value_name='id')
